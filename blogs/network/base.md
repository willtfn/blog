---
title: 计算机网络基础
date: 2021-08-14
tags:
  - 计算机网络
  - DNS
  - HTTP
  - TCP/IP
categories:
  - 计算机网络
---

## 计算机网络层级结构

## 物理层

## 数据链路层

## 网络层

## 运输层

## 应用层

运输层为应用提供了端到端的通信服务，不同的网络应用的`应用进程`之间的通信则需要应用层协议。

应用层协议包括以下常见类型：

- 域名系统 DNS 协议。
- FTP 文件传输协议。
- TELNET 远程终端协议
- HTTP（超文本传输协议），万维网的应用层协议。
- SMTP 电子邮件协议。
- POP3 邮件读取协议。
- ...

:::tip
注意，应用层协议与网络应用并不是同一个概念。应用层协议只是网络应用的一部分。
:::

什么是应用？

以万维网为例，万维网浏览器、万维网服务器等都属于万维网应用。

### 域名系统 DNS

域名系统 DNS (Domain Name System)是因特网使用的命名系统，用来把便于人们使用的机器名字转换为 IP 地址。

用户与因特网上某个主机通信时，必须要知道对方的 IP 地址。然而用户很难记住长达 32 位二进制主机地址。即使是点分十进制 IP 地址也并不太容易记忆。但在应用层为了便于用户记忆各种网络应用，更多的是使用主机名字。比如我们访问必应网站时，只需要输入域名 <https://cn.bing.com/> 即可，而不是输入它的 IP 地址。

#### 域名结构

<img src="./images/base_domain_1.png" width="300" />

如图所示：域名以从右向左的顺序，依次为顶级域名、二级域名、三级域名、等等...

常见的顶级域名有：

- .com，公司企业
- .cn，中国
- .us，美国
- .net，网络服务机构
- .edu，教育机构
- ...

#### 域名服务器

DNS 服务器的管辖范围是以”区“为单位的，每一个区设置相应的权限域名服务器(authoritative name server)，用来保存该区中的所有主机的域名到 IP 地址的映射。区可能等于或小于域，但一定不可能大于域。

<img src="./images/base_domain_2.png" style="max-width:80%" />

1. 根域名服务器

   根域名服务器是最高层次的域名服务器，也是最重要的域名服务器。所有的根域名服务器都知道所有的顶级域名服务器的域名和 IP 地址。根域名服务器是最重要的域名服务器，因为不管是哪一个本地域名服务器，若要对因特网上任何一个域名进行解析（即转换为 IP 地址），只要自己无法解析，就首先要求助于根域名服务器。

   需要注意的是，在许多情况下，根域名服务器并不直接把待查询的域名直接转换成 IP 地址（根域名服务器也没有存放这种信息），而是告诉本地域名服务器下一步应当找哪一个顶级域名服务器进行查询。

2. 顶级域名服务器

   这些域名服务器负责管理在该顶级域名服务器注册的所有二级域名。当收到 DNS 查询请求时，就给出相应的回答（可能是最后的结果，也可能是下一步应当找的域名服务器的 IP 地址）。

3. 权限域名服务器

   这就是前面已经讲过的负责一个区的域名服务器。当一个权限域名服务器还不能给出最后的查询回答时，就会告诉发出查询请求的 DNS 客户，下一步应当找哪一个权限域名服务器。

4. 本地域名服务器

   当一个主机发出 DNS 查询请求时，这个查询请求报文会先发送给本地域名服务器，也称为默认域名服务器。当所要查询的主机也属于同一个本地 ISP 时，该本地域名服务器立即就能将所查询的主机名转换为它的 IP 地址，而不需要再去询问其他的域名服务器。

**域名是如何解析的呢？**

首先了解两个概念：

1. 递归查询

   如果主机所询问的本地域名服务器不知道被查询域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文（即替该主机继续查询），而不是让该主机自己进行下一步的查询。因此，递归查询返回的查询结果或者是所要查询的 IP 地址，或者是报错，表示无法查询到所需的 IP 地址。

2. 迭代查询

   当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询（而不是替本地域名服务器进行后续的查询）。

如下图所示：

<img src="./images/base_domain_3.png" style="max-width:80%" />

图中(a)的查询步骤：

1. 主机 m.xyz.com 先向其本地域名服务器 dns.xyz.com 进行递归查询。
2. 本地域名服务器采用迭代查询。它先向一个根域名服务器查询。
3. 根域名服务器告诉本地域名服务器，下一次应查询的顶级域名服务器 dns.com 的 IP 地址。
4. 本地域名服务器向顶级域名服务器 dns.com 进行查询。
5. 顶级域名服务器 dns.com 告诉本地域名服务器，下一次应查询的权限域名服务器 dns.abc.com 的 IP 地址。
6. 本地域名服务器向权限域名服务器 dns.abc.com 进行查询。
7. 权限域名服务器 dns.abc.com 告诉本地域名服务器，所查询的主机的 IP 地址。
8. 本地域名服务器最后把查询结果告诉主机 m.xyz.com。

::: tip
注意：

- 主机向本地域名服务器的查询一般都是采用递归查询。

- 本地域名服务器向根域名服务器的查询通常是采用迭代查询。当然，本地域名服务器也可以采用递归查询，这取决于最初的查询请求报文的设置是要求使用哪一种查询方式。

:::

### 超文本传输协议 HTTP

每个万维网网点都有一个服务器进程，它不断地监听 TCP 的端口 80，以便发现是否有浏览器向它发出连接建立请求。一旦监听到连接建立请求并建立了 TCP 连接之后，浏览器就向万维网服务器发出浏览某个页面的请求，服务器接着就返回所请求的页面作为响应。最后，TCP 连接就被释放了。在浏览器和服务器之间的请求和响应的交互，必须按照规定的格式和遵循一定的规则。这些格式和规则就是超文本传送协议 HTTP。

**当在浏览器中输入一个 URL 并发起请求时，都发生了什么呢？**

1. 浏览器分析链接指向页面的 URL（比如是：<https://www.baidu.com/>）。
2. 浏览器向 DNS 请求解析 www.baidu.com 的 IP 地址。
3. 域名系统 DNS 解析出对应服务器的 IP 地址。
4. 浏览器与服务器建立 TCP 连接。
5. 浏览器发出取文件命令。
6. 服务器给出响应，把文件 index.htm 发送给浏览器。
7. 释放 TCP 连接。
8. 浏览器显示百度页面内容。

#### HTTP 状态码

HTTP 状态码都是三位数字的，分为 5 大类。

- 1xx，表示通知信息的，如请求收到了或正在进行处理。
- 2xx，表示成功，如接受或知道了。
- 3xx，表示重定向，如要完成请求还必须采取进一步的行动。
- 4xx，表示客户端差错，如请求中有错误的语法或不能完成。
- 5xx，表示服务端差错，如服务器失效无法完成请求。

## 参考

- 《计算机网络》（第 6 版 谢希仁 ）
